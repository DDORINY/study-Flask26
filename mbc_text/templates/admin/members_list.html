{% extends "layout.html" %}
{% block title %}회원 목록{% endblock %}

{% block content %}
{% set title="회원 목록" %}
{% set desc="활성/비활성 필터 및 검색이 가능합니다." %}
{% include "_partials/page_header.html" %}

<div class="card p-4">

  <form class="row g-2 align-items-center" method="GET" action="{{ url_for('admin.members') }}">
    <div class="col-md-3">
      <select class="form-select" name="mode">
        <option value="all" {% if mode=='all' %}selected{% endif %}>전체</option>
        <option value="active" {% if mode=='active' %}selected{% endif %}>활성</option>
        <option value="inactive" {% if mode=='inactive' %}selected{% endif %}>비활성</option>
      </select>
    </div>
    <div class="col-md-6">
      <input class="form-control" name="q" value="{{ q }}" placeholder="검색 (아이디/이름/이메일)">
    </div>
    <div class="col-md-3 d-grid">
      <button class="btn btn-brand" type="submit">검색</button>
    </div>
  </form>

  <hr class="my-4">

  {% if members and members|length > 0 %}
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr>
            <th>#</th>
            <th>아이디</th>
            <th>이름</th>
            <th>연락처</th>
            <th>이메일</th>
            <th>주소</th>
            <th>상태</th>
            <th class="text-end">관리</th>
          </tr>
        </thead>
        <tbody>
          {% for m in members %}
          <tr>
            <td class="text-muted">{{ m.id }}</td>
            <td class="fw-semibold">{{ m.uid }}</td>
            <td>{{ m.name }}</td>
            <td>{{ m.phone }}</td>
            <td>{{ m.email }}</td>
            <td>{{ m.address }}</td>
            <td>
              {% if m.active == 1 %}
                <span class="badge-soft">활성</span>
              {% else %}
                <span class="badge-soft">비활성</span>
              {% endif %}
            </td>
            <td class="text-end">
              <a class="btn btn-soft btn-sm" href="{{ url_for('admin.member_detail', member_id=m.id) }}">상세</a>

              {% if m.active == 1 %}
                <form class="d-inline" method="POST" action="{{ url_for('admin.member_disable', member_id=m.id) }}">
                  <button class="btn btn-outline btn-sm" type="submit">비활성화</button>
                </form>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    {% set title="회원 데이터가 없습니다." %}
    {% set desc="검색 조건을 변경하거나 회원 가입 데이터를 확인하세요." %}
    {% include "_partials/empty_state.html" %}
  {% endif %}
</div>
{% endblock %}